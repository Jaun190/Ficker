<!DOCTYPE html>
<html lang="de">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>GrowEmpire Passwort zur√ºcksetzen</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body style="background-image: url('assets/kiffen.png'); background-size: 95%; background-position: top; background-repeat: no-repeat;">
    <div class="form-container">
      <h2>GrowEmpire Passwort zur√ºcksetzen</h2>
      <form id="reset-form">
        <input type="email" id="email" placeholder="E-Mail" required />
        <button type="submit">üîí Link senden</button>
      </form>
      <p><a href="index.html">Zur√ºck zum Login</a></p>
      <p id="error-msg" class="error"></p>
      <p id="success-msg" style="color: #00ff88;"></p>
    </div>

    <!-- SUPABASE RESET -->
    <script type="module">
      import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm';

      const supabase = createClient(
        'https://ghfzdgaunxblpudkmxmy.supabase.co',
        'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdoZnpkZ2F1bnhibHB1ZGtteG15Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTA3MDI5NTksImV4cCI6MjA2NjI3ODk1OX0.J8ni4SszaI33ljthdEjqXf8ZKFCs4uWnRZZDyU0IlUU'
      );

      document.getElementById('reset-form').addEventListener('submit', async (e) => {
        e.preventDefault();
        const email = document.getElementById('email').value;
        const errorMsg = document.getElementById('error-msg');
        const successMsg = document.getElementById('success-msg');
        errorMsg.textContent = '';
        successMsg.textContent = '';

        const { error } = await supabase.auth.resetPasswordForEmail(email, {
          redirectTo: 'https://ficker.vercel.app/reset.html'
        });

        if (error) {
          errorMsg.textContent = '‚ùå Fehler: ' + error.message;
        } else {
          successMsg.textContent = '‚úÖ Link wurde gesendet. Bitte pr√ºfe deine E-Mail.';
        }
      });
    </script>
  </body>
</html>
